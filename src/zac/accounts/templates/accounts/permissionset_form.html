{% extends "master.html" %}
{% load i18n sniplates l10n %}


{% block content %}
<h1 class="page-title">
    {% if form.instance.id %}
        Change {{ form.instance.name }}
    {% else %}
        Nieuwe permission set
    {% endif %}
</h1>


<form action="." method="post" class="form">
    {% csrf_token %}

    {% load_widgets form='sniplates/forms.html' %}

    {% widget 'form:non_field_errors' %}

    <div class="form__field-group">
        {% form_field form.name %}
        {% form_field form.description %}
    </div>

    <div class="form__field-group">
        {% form_field form.permissions %}
    </div>

    <div class="form__field-group">
        {% form_field form.catalogus %}
        {{ form.get_zaaktypen|json_script:"catalogus-zaaktypen" }}
        {{ form.get_initial_zaaktypen|json_script:"initial-zaaktypen" }}
        {% form_field form.zaaktype_identificaties "form:CheckboxSelectDynamic" listen="id_catalogus" values="catalogus-zaaktypen" initial="initial-zaaktypen"%}
    </div>

    {% form_field form.max_va %}

    <h3>Informatieobjecttypen</h3>
    <div class="informatieobjecttype-permissions"
        data-prefix="{{ informatieobjecttype_formset.prefix }}"
        data-initial="{{ informatieobjecttype_formset.initial_form_count|unlocalize }}"
        data-extra="{{ informatieobjecttype_formset.extra|unlocalize }}"
        data-min-num="{{ informatieobjecttype_formset.min_num|unlocalize }}"
        data-max-num="{{ informatieobjecttype_formset.max_num|unlocalize }}"
        data-catalog-choices="catalog-choices"
        data-existing-form-data="existing-form-data"
    >
        {{ informatieobjecttype_formset.catalog_choices|json_script:"catalog-choices" }}
        {{ informatieobjecttype_formset.existing_form_data|json_script:"existing-form-data" }}
        {# Managed by react #}
    </div>

    {% if form.instance.id %}
        {% trans "Change" as btn_label %}
    {% else %}
        {% trans "Add" as btn_label %}
    {% endif %}
    {% widget 'form:submit' label=btn_label %}
</form>

{% endblock %}
