<gu-loading-indicator *ngIf="isLoading" overlayGrey></gu-loading-indicator>
<form class="search-form" [formGroup]="searchForm">
  <div class="form-group">
    <p>Vind zaken op basis van hun eigenschappen.</p>
    <div class="row">
      <div class="col-lg-6">
        <gu-multiselect *ngIf="zaaktypenData"
                        [control]="zaaktype"
                        (change)="onZaaktypeSelect($event)"
                        [searchable]="true"
                        [items]="zaaktypenData"
                        [multiple]="false"
                        bindLabel="omschrijving"
                        bindValue="identificatie"
                        label="Zaaktype">
        </gu-multiselect>
      </div>
    </div>
  </div>
  <div class="form-group">
    <div class="row">
      <div class="col-lg-4">
        <gu-input-field type="text"
                        [control]="omschrijving"
                        label="Omschrijving"
                        autocomplete="off"
        ></gu-input-field>
      </div>
    </div>
  </div>
  <ng-container *ngIf="zaaktypeEigenschappenData.length > 0">
    <h4 class="mb-4">Eigenschappen</h4>
    <div class="row">
      <div class="col-lg-6">
        <div class="form-group">
          <gu-multiselect (change)="onPropertySelect($event)"
                          [control]="eigenschapnaam"
                          [searchable]="true"
                          [items]="zaaktypeEigenschappenData"
                          [multiple]="false"
                          bindLabel="name"
                          bindValue="name"
                          label="Eigenschapnaam">
          </gu-multiselect>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-lg-4" *ngIf="selectedPropertyValue && eigenschapnaam.value">
        <div class="form-group" *ngIf="eigenschapwaarde">
          <ng-container [ngSwitch]="selectedPropertyValue.spec.type">
            <ng-container *ngSwitchCase="'string'">
              <ng-container *ngIf="selectedPropertyValue.spec.format !== 'date'">
                <gu-input-field type="text"
                                [control]="eigenschapwaarde"
                                label="Eigenschapwaarde"
                                autocomplete="off"
                ></gu-input-field>
              </ng-container>
              <ng-container *ngIf="selectedPropertyValue.spec.format === 'date'">
                <gu-datepicker
                  [control]="eigenschapwaarde"
                  label="Datum"
                  id="searchDatum">
                </gu-datepicker>
              </ng-container>
            </ng-container>
            <ng-container *ngSwitchCase="'number'">
              <gu-input-field type="number"
                              [control]="eigenschapwaarde"
                              label="Eigenschapwaarde"
                              autocomplete="off"
              ></gu-input-field>
            </ng-container>
          </ng-container>
        </div>
      </div>
    </div>
  </ng-container>
  <div class="row">
    <div class="col-lg-6">
      <div class="form-group">
        <gu-checkbox class="d-inline-block mr-1"
                     [control]="saveReportControl"
                     (change)="onCheckboxChange()"
        >
          Zoekopdracht opslaan als rapportage
        </gu-checkbox>
        <gu-tooltip type="primary" inline="true">
          <p class="p--nomargin">De ingevulde zoekopdracht kan opgeslagen worden als een <strong>rapportage</strong>. Selecteer het vinkje en geef de rapportage een naam. De opgeslagen rapportage vindt u terug onder het menu <strong>Rapportage</strong>.</p>
        </gu-tooltip>
      </div>
    </div>
  </div>
  <div class="row" *ngIf="showReportNameField">
    <div class="col-lg-4">
      <div class="form-group">
        <gu-input-field type="text"
                        [control]="queryNameControl"
                        label="Rapportagenaam"
                        autocomplete="off"
        ></gu-input-field>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-lg-4">
      <gu-message class="d-block mb-4" type="success" *ngIf="saveReportIsSuccess">
        <p class="p--marginsmall">Rapportage <strong>{{reportName}}</strong> is nu opgeslagen onder het menu "Rapportages".</p>
        <a class="anchor d-inline-block" routerLink='/rapportages'>Naar Rapportages</a>
        <gu-icon class="d-inline-block">navigate_next</gu-icon>
      </gu-message>
    </div>
  </div>
  <div class="d-flex justify-content-end justify-content-lg-center">
    <button gu-button size="large"
               [disabled]="!searchForm.valid || isSubmitting"
               [loading]="isSubmitting"
               (click)="submitForm()">
      {{showReportNameField ? 'Zoeken en rapportage opslaan' : 'Zoeken'}}
    </button>
  </div>
</form>
